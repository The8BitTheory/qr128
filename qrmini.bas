#RetroDevStudio.MetaData.BASIC:7169,BASIC V7.0,uppercase,10,10
1 GRAPHIC1:GRAPHIC0:GRAPHIC5
5 BANK 15
#10 T$="HTTPS://WWW.FORUM64.DE/INDEX.PHP?THREAD/141120-HALLOWEEN-LEVTY-SPEZIAL-GRUSELSCHOCKER-TURNIER/"
10 T$="HTTPS://WWW.FORUM64.DE/"
20 I=POINTER(T$)
30 BANK1:P1=PEEK(I+1):P2=PEEK(I+2):P=PEEK(I):BANK15

35 PRINT "CALLING INIT"
40 SYS DEC("1300"),P,P1,P2

45 PRINT "CALLING P2A"
50 SYS DEC("1303")

55 PRINT "CALLING BYTES2STREAM"
60 SYS DEC("1306")

65 PRINT "CALLING CALC-XOR-MASKS"
70 SYS DEC("1309")

75 PRINT "CALLING RS"
80 SYS DEC("130C")

85 PRINT "CALLING WRITE PATTERNS"
90 SYS DEC("130F")
#91 INPUT "PRESS RETURN TO WRITE STREAM TO MODULES";I$


95 PRINT "CALLING STREAM2MODULE"
100 SYS DEC("1312")

105 PRINT "EXPORTING ADRESSES"
110 SYS DEC("1315")

150 BANK0:F=PEEK(1000)+PEEK(1001)*256:L=PEEK(1002)
160 PRINT "START OF MATRIX="F"/"HEX$(F)", L="L
162 PRINT "XORING WITH PATTERN IN BIT 1"
170 O=F:C=0:R=0:GRAPHIC0:COLOR5,1:COLOR0,2:COLOR4,2:PRINT""CHR$(27)"M";:PRINT " ";

200 IF L<=25 THEN 1000
210 GOTO 6000

######
# PRINT FULL MODULES
#########
# MV:MASK-VALUE (2 MEANS BIT 1, BECAUSE 2BIT)
# DV:DATA-VALUE
# XV:XMASK-VALUE
# DV AND XV ARE XORED

1000 MV=2
1005 FOR Y=1 TO L
1010  FOR X=1 TO L

1020   PO=PEEK(O)
1021   DV=ABS((PO AND 1)=1)
1022   XV=ABS((PO AND MV)=MV)
1023   V=XOR(DV,XV)

1030   IF V=1 THEN PRINT CHR$(18)" "CHR$(146);:ELSE PRINT " ";

1040   O=O+1
1050   IF X = L THEN PRINT" ":PRINT" ";

1060  NEXT
1070 NEXT

1080 GRAPHIC5



1090 END



######
# PRINT 4 MODULES PER CHARACTER
########



6000 SLOW:REM OUTPUT MATRIX TO SCREEN
6103 DIM CH$(15)
6104 CH$(0)=CHR$(32):CH$(1)=CHR$(190):CH$(2)=CHR$(188):CH$(3)=CHR$(18)+CHR$(162)+CHR$(146)
6105 CH$(4)=CHR$(187):CH$(5)=CHR$(161):CH$(6)=CHR$(18)+CHR$(191)+CHR$(146):CH$(7)=CHR$(18)+CHR$(172)+CHR$(146)
6106 CH$(8)=CHR$(172):CH$(9)=CHR$(191):CH$(10)=CHR$(18)+CHR$(161)+CHR$(146):CH$(11)=CHR$(18)+CHR$(187)+CHR$(146)
6107 CH$(12)=CHR$(162):CH$(13)=CHR$(18)+CHR$(188)+CHR$(146):CH$(14)=CHR$(18)+CHR$(190)+CHR$(146):CH$(15)=CHR$(18)+CHR$(32)+CHR$(146)


6160 PB=0
6170 PRINT "PRINTING VALUES THAT MATCH AND "PB

6172  FT=PB:IF FT=0 THEN PRINT "0":GT=1
6174  IF FT>0 THEN IF FT<5 THEN PRINT "1-4":GT=2
6176  IF ASC(I$)>=ASC("A") THEN IF ASC(I$)<=ASC("D") THEN PRINT"A-D":FT=ASC(I$)-64:GT=3
6177  IF ASC(I$)=ASC("Z") THEN GT=4
6178  PRINT"GT="GT

#6110 GOTO 6300
# R:ROW
# C:COL
# O:OFFSET
# F:START OF MATRIX
# G:END OF MATRIX
# RENDERING OPTIONS
# - SHOW ADMINISTRATIVE PATTERNS AND DATASTREAM (NO XORING): 0
# - SHOW XOR WITH EVERY MASK (4) : 1-4
# - SHOW MASKS INDIVIDUALLY (4) : A-D



6221 DEF FN PA(ZZ)=((PO AND ZZ)=ZZ)

6222 DO WHILE R<=(L-1)/2


6225 ON GT GOTO 6230,6240,6250,6256
6226 PRINT"INVALID INPUT:"GT:END

# SHOW DATASTREAM ONLY
# FOR EVERY VALUE, JUST SHOW LOWEST BIT
6230  PO=PEEK(O):V1=POAND1
6231  PO=PEEK(O+1):V2=POAND1
6232  PO=PEEK(O+L):V3=POAND1
6233  PO=PEEK(O+L+1):V4=POAND1
6239  GOTO 6260

# SHOW MASKED DATA
# VALUES WITH AND64 HAVE LOWEST BIT XORED WITH MASK-BIT, OTHERS JUST SHOW LOWEST BIT
6240  PO=PEEK(O):DV=POAND1:MV=ABS(FNPA(FT))
6241  IF FNPA(64) THEN V1=XOR(DV,MV):ELSE V1=DV

6242  PO=PEEK(O+1):DV=POAND1:MV=ABS(FNPA(FT))
6243  IF FNPA(64) THEN V2=XOR(DV,MV):ELSE V2=DV

6244  PO=PEEK(O+L):DV=POAND1:MV=ABS(FNPA(FT))
6245  IF FNPA(64) THEN V3=XOR(DV,MV):ELSE V3=DV

6246  PO=PEEK(O+1+L):DV=POAND1:MV=ABS(FNPA(FT))
6247  IF FNPA(64) THEN V4=XOR(DV,MV):ELSE V4=DV

6249  GOTO 6260

# SHOW MASKS
# JUST SHOW THE VALUE OF THE MASK-BIT
# MB:MASK-BIT (EG 1)
# MV:MASK-VALUE (EG 2)
6250  MB=ASC(I$)-64:MV=2MB

6251  PO=PEEK(O):IF FNPA(MV) THEN V1=ABS(FNPA(MV)):ELSE V1=0
6252  PO=PEEK(O+1):IF FNPA(MV) THEN V2=ABS(FNPA(MV)):ELSE V2=0
6253  PO=PEEK(O+L):IF FNPA(MV) THEN V3=ABS(FNPA(MV)):ELSE V3=0
6254  PO=PEEK(O+L+1):IF FNPA(MV) THEN V4=ABS(FNPA(MV)):ELSE V4=0
6255  GOTO 6260

6256  PO=PEEK(O):IF FNPA(128) THEN V1=ABS(PO>=128):ELSEV1=0
6257  PO=PEEK(O+1):IF FNPA(128) THEN V2=ABS(PO>=128):ELSEV2=0
6258  PO=PEEK(O+L):IF FNPA(128) THEN V3=ABS(PO>=128):ELSEV3=0
6259  PO=PEEK(O+L+1):IF FNPA(128) THEN V4=ABS(PO>=128):ELSEV4=0


6260  IF R<L-1 THEN IF C<L-1 THEN V=V1+V2*2+V3*4+V4*8
6261  IF R=L-1 THEN IF C=L-1 THEN V=V1
6262  IF R=L-1 THEN IF C<L-1 THEN V=V1+V3*4

6263  PRINT CH$(V);
6264  O=O+2
6265  C=C+2:IF C >= L THEN O=O+L-1:C=0:R=R+1:PRINT" ":PRINT" ";
6270 LOOP

# LAST ROW IS HANDLED INDIVIDUALLY
#6271 FOR Y=0TO(L-1)/2

#6273  PO=PEEK(O):DV=POAND1:MV=ABS(FNPA(FT))
#6274  IF FNPA(64) THEN V1=XOR(DV,MV):ELSE V1=DV
#6274 IF ((PO AND 64)=64) THEN V1=1

#6275  PO=PEEK(O+1):DV=POAND1:MV=ABS(FNPA(FT))
#6276  IF FNPA(64) THEN V2=XOR(DV,MV):ELSE V2=DV
#6276 IF ((PO AND 64)=64) THEN V2=1

#6277  IF C<L-1 THEN V=V1+V2*2:ELSE V=V1
#6279  PRINT CH$(V);
#6281  O=O+2:C=C+2
#6283 NEXT
6285 PRINT " "

6290 PRINT:GRAPHIC5

6300 INPUT "WHICH AND VALUE TO PRINT";I$
6305 IF I$="X" THEN 6400
6310 PB=VAL(I$)
6320 GOTO 6170


6400 BANK15